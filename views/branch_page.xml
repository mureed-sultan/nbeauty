<?xml version="1.0" encoding="UTF-8"?>
<odoo>
  <template id="template_branch_listing" name="Branch Listing Page">
    <t t-call="website.layout">
      <t t-set="page_name" t-value="'branches'" />

      <section class="section pt-10 pb-10">
        <div class="container">
          <h2 class="_4block-title text-center mb-5">Branch Locations</h2>

          <!-- City Filter Buttons -->
          <div class="flex flex-wrap justify-center gap-3 mb-8">
            <a href="/branches"
               t-att-class="'btn-filter' + (' active' if not selected_city else '')">
              All
            </a>
            <t t-foreach="cities" t-as="city">
              <a t-attf-href="/branches?city_id={{ city.id }}"
                 t-att-class="'btn-filter' + (' active' if selected_city == city.id else '')">
                <t t-esc="city.name"/>
              </a>
            </t>
          </div>

          <!-- Branch Cards -->
          <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
            <t t-foreach="branches" t-as="branch">
              <div class="_card-box bg-white shadow-md rounded-2xl p-5 flex flex-col h-full">

                <t t-if="branch.image">
                  <img t-att-src="'data:image/png;base64,%s' % branch.image"
                       class="rounded-xl w-full h-40 object-cover mb-4"/>
                </t>

                <h4 class="text-lg font-bold mb-1 text-black">
                  <t t-esc="branch.name"/>
                </h4>

                <p class="text-sm text-gray-700 mb-1">
                  <i class="fa fa-phone text-primary mr-1"></i>
                  <a t-att-href="'tel:' + (branch.phone or '')" class="hover:underline">
                    <t t-esc="branch.phone"/>
                  </a>
                </p>

                <p class="text-sm text-gray-700 mb-1">
                  <i class="fa fa-whatsapp text-success mr-1"></i>
                  <a t-att-href="'https://wa.me/' + (branch.whatsapp or '')" target="_blank"
                     class="hover:underline">
                    <t t-esc="branch.whatsapp"/>
                  </a>
                </p>

                <p class="text-sm text-gray-500 mb-2">
                  <t t-esc="branch.address"/>
                </p>

                <a t-att-href="branch.map_url" target="_blank"
                   class="text-sm text-white bg-primary hover:opacity-90 text-center py-2 px-4 rounded-xl mt-auto">
                  View on Map
                </a>
              </div>
            </t>
          </div>
        </div>
      </section>
    </t>
  </template>
</odoo>
